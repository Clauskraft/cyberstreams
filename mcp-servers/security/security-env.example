# MCP Security Configuration
# Environment variables for security settings

# JWT Configuration
MCP_JWT_SECRET=cyberstreams-mcp-secret-key-2025-super-secure
MCP_JWT_EXPIRES_IN=24h
MCP_REFRESH_TOKEN_EXPIRES_IN=7d

# Password Hashing
MCP_BCRYPT_ROUNDS=12

# Session Configuration
MCP_SESSION_SECRET=cyberstreams-session-secret-2025-super-secure
MCP_SESSION_COOKIE_SECURE=true
MCP_SESSION_COOKIE_HTTP_ONLY=true
MCP_SESSION_COOKIE_MAX_AGE=86400000

# CORS Configuration
MCP_CORS_ORIGIN=http://localhost:3000,http://localhost:5173,https://cyberstreams.dk
MCP_CORS_CREDENTIALS=true

# Rate Limiting
MCP_RATE_LIMIT_WINDOW_MS=900000
MCP_RATE_LIMIT_MAX_REQUESTS=100

# API Keys
MCP_VALID_API_KEYS=cyberstreams-api-key-1,cyberstreams-api-key-2,cyberstreams-api-key-3

# Network Security
MCP_ALLOWED_IPS=127.0.0.1,::1,192.168.1.0/24
MCP_BLOCKED_IPS=
MCP_MAX_CONNECTIONS_PER_IP=100

# Logging
MCP_LOG_LEVEL=info
MCP_LOG_SECURITY_EVENTS=true
MCP_LOG_FAILED_ATTEMPTS=true
MCP_LOG_SUCCESSFUL_LOGINS=false
MCP_LOG_DATA_ACCESS=true

# Encryption
MCP_ENCRYPTION_ALGORITHM=aes-256-gcm
MCP_ENCRYPTION_KEY_LENGTH=32
MCP_ENCRYPTION_IV_LENGTH=16

# Monitoring
MCP_MONITORING_ENABLED=true
MCP_METRICS_ENDPOINT=/metrics
MCP_HEALTH_CHECK_ENDPOINT=/health

# Alert Thresholds
MCP_ALERT_ERROR_RATE=0.05
MCP_ALERT_RESPONSE_TIME=1000
MCP_ALERT_MEMORY_USAGE=0.8
MCP_ALERT_CPU_USAGE=0.8

# Data Protection
MCP_GDPR_COMPLIANT=true
MCP_DATA_RETENTION_DAYS=365
MCP_ANONYMIZE_LOGS=true
MCP_ENCRYPT_SENSITIVE_DATA=true

# Threat Detection
MCP_THREAT_DETECTION_ENABLED=true
MCP_MAX_SUSPICIOUS_REQUESTS=10
MCP_BLOCK_DURATION=3600000

# Security Headers
MCP_SECURITY_HEADERS_ENABLED=true
MCP_CSP_ENABLED=true
MCP_HSTS_ENABLED=true
MCP_X_FRAME_OPTIONS=DENY
MCP_X_CONTENT_TYPE_OPTIONS=nosniff
MCP_X_XSS_PROTECTION=1; mode=block

# Input Validation
MCP_MAX_INPUT_LENGTH=10000
MCP_ALLOWED_FILE_TYPES=.json,.xml,.txt
MCP_MAX_FILE_SIZE=10485760
MCP_SANITIZE_HTML=true
MCP_VALIDATE_JSON=true

# Audit
MCP_AUDIT_ENABLED=true
MCP_AUDIT_LOG_LEVEL=info
MCP_AUDIT_INCLUDE_REQUEST_BODY=false
MCP_AUDIT_INCLUDE_RESPONSE_BODY=false
MCP_AUDIT_SENSITIVE_FIELDS=password,token,apiKey,secret

# Database Security
MCP_DB_ENCRYPTION_ENABLED=true
MCP_DB_CONNECTION_POOL_SIZE=10
MCP_DB_CONNECTION_TIMEOUT=30000
MCP_DB_QUERY_TIMEOUT=10000

# External API Security
MCP_EXTERNAL_API_TIMEOUT=10000
MCP_EXTERNAL_API_RETRY_ATTEMPTS=3
MCP_EXTERNAL_API_RETRY_DELAY=1000

# Backup and Recovery
MCP_BACKUP_ENABLED=true
MCP_BACKUP_FREQUENCY=daily
MCP_BACKUP_RETENTION_DAYS=30
MCP_BACKUP_ENCRYPTION_ENABLED=true

# Compliance
MCP_SOC2_COMPLIANT=true
MCP_ISO27001_COMPLIANT=true
MCP_PCI_DSS_COMPLIANT=false
MCP_HIPAA_COMPLIANT=false

# Security Testing
MCP_SECURITY_TESTING_ENABLED=true
MCP_SECURITY_TEST_FREQUENCY=daily
MCP_SECURITY_TEST_TIMEOUT=30000

# Incident Response
MCP_INCIDENT_RESPONSE_ENABLED=true
MCP_INCIDENT_RESPONSE_EMAIL=security@cyberstreams.dk
MCP_INCIDENT_RESPONSE_PHONE=+45-12345678
MCP_INCIDENT_RESPONSE_SLACK_WEBHOOK=

# Security Policies
MCP_PASSWORD_MIN_LENGTH=8
MCP_PASSWORD_REQUIRE_UPPERCASE=true
MCP_PASSWORD_REQUIRE_LOWERCASE=true
MCP_PASSWORD_REQUIRE_NUMBERS=true
MCP_PASSWORD_REQUIRE_SYMBOLS=true
MCP_PASSWORD_MAX_AGE_DAYS=90
MCP_PASSWORD_HISTORY_COUNT=5

# User Management
MCP_USER_REGISTRATION_ENABLED=true
MCP_USER_EMAIL_VERIFICATION_REQUIRED=true
MCP_USER_ACCOUNT_LOCKOUT_ENABLED=true
MCP_USER_ACCOUNT_LOCKOUT_ATTEMPTS=5
MCP_USER_ACCOUNT_LOCKOUT_DURATION=900000

# API Security
MCP_API_VERSIONING_ENABLED=true
MCP_API_DEPRECATION_WARNING_DAYS=90
MCP_API_RATE_LIMIT_PER_USER=1000
MCP_API_RATE_LIMIT_PER_IP=100

# Content Security
MCP_CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'
MCP_REFERRER_POLICY=strict-origin-when-cross-origin
MCP_PERMISSIONS_POLICY=geolocation=(), microphone=(), camera=()

# Security Headers Override
MCP_SECURITY_HEADERS_OVERRIDE=false
MCP_CUSTOM_SECURITY_HEADERS=

# Development vs Production
MCP_DEVELOPMENT_MODE=false
MCP_DEBUG_MODE=false
MCP_VERBOSE_LOGGING=false
MCP_TEST_MODE=false



